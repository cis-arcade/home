characterData = [
    {
        "name" : "Goku",
        "power" : 0.9,
        "durability" : 0.9,
        "speed" : 0.6,
        "combat skills" : 0.4,
        "image" : "https://pbs.twimg.com/profile_images/1366466342354751491/JyhZpbtu_400x400.jpg"
    },
    {
        "name" : "Zoro",
        "power" : 0.5,
        "durability" : 0.8,
        "speed" : 0.3,
        "combat skills" : 0.8,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRZGMBHxkTOfZC0sIeQSgypyHVlLwq8GREORw&s"
    },
    {
        "name" : "Gumball",
        "power" : 0.2,
        "durability" : 0.9,
        "speed" : 0.9,
        "combat skills" : 0.4,
        "image" : "https://static.wikia.nocookie.net/characters/images/1/18/Season_3_Gumball_28Improved_29.png/revision/latest?cb=20230708001747"
    },
    {
        "name" : "Naruto",
        "power" : 0.9,
        "durability" : 0.7,
        "speed" : 0.9,
        "combat skills" : 1.2,
        "image" : "https://variety.com/wp-content/uploads/2024/08/NARSHP_set2_screen_3x2cr-res.jpg?w=1000&h=667&crop=1"
    },
    {
        "name" : "Tanjiro",
        "power" : 0.8,
        "durability" : 0.7,
        "speed" : 0.9,
        "combat skills" : 0.8,
        "image" : "https://a.storyblok.com/f/178900/960x540/6e6bcda041/demon-slayer.jpg/m/filters:quality(95)format(webp)"
    },
    {
        "name" : "Meliodas",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://static1.cbrimages.com/wordpress/wp-content/uploads/2020/05/Meliodas-Seven-Deadly-Sins-Cropped.jpg"

  
  },
    {
  "name" : "Vanellope",
        "power" : 0.8,
        "durability" : 0.3,
        "speed" : 0.9,
        "combat skills" : 0.4,
        "image" : "https://eartotheretravel.com/wp-content/uploads/2015/10/Vanellope_profile.png"
    },
    {
 "name" : "Raven",
        "power" : 0.8,
        "durability" : 0.9,
        "speed" : 0.7,
        "combat skills" : 0.7,
        "image" : "https://i.ytimg.com/vi/xG_8cepY6Sw/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLBUZc5LJR445FH-RuFKfM0CjI2Iqw"
     
     },
    {
  "name" : "Denji",
        "power" : 0.8,
        "durability" : 0.7,
        "speed" : 0.5,
        "combat skills" : 0.8,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRpKWbQxztg3izIxyOoczWiTb_pifNeuK8pfA&s"
    
       },
    {
  "name" : "Craig",
        "power" : 0.4,
        "durability" : 0.3,
        "speed" : 0.7,
        "combat skills" : 0.8,
        "image" : "https://cn.i.cdn.ti-platform.com/content/1539/craig-of-the-creek/showpage/za/craig.48956a2a.jpg"
        
        },
    {
  "name" : "couragecowardlydog",
        "power" : 0.1,
        "durability" : 0.5,
        "speed" : 0.9,
        "combat skills" : 0.4,
        "image" : "https://www.awn.com/sites/default/files/styles/original/public/image/attached/1058366-couragecowardlydogcsr-1280.jpg?itok=U3ueovvl"
       
     },
    {
  "name" : "Timmy Turner",
        "power" : 0.8,
        "durability" : 0.9,
        "speed" : 0.3,
        "combat skills" : 0.5,
        "image" : "https://www.famousbirthdays.com/group_images/medium/timmy-turner-played.jpg"
    
     },
    {
  "name" : "Jake",
        "power" : 0.5,
        "durability" : 0.9,
        "speed" : 0.6,
        "combat skills" : 0.7,
        "image" : "https://content.presspage.com/uploads/1441/1920_commercial-desk.png?10000"
    
     },
    {
  "name" : "TinkerBell",
        "power" : 0.3,
        "durability" : 0.9,
        "speed" : 0.9,
        "combat skills" : 0.7,
        "image" : "https://d23.com/app/uploads/2018/12/1180w-600h_121218_tinker-bell-fun-facts-780x440.jpg"
    
     },
    {
  "name" : "Robot Chicken",
        "power" : 0.5,
        "durability" : 0.9,
        "speed" : 0.9,
        "combat skills" : 0.4,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKq43gadLEZsjcZohfVzd-zepYpbCiTscJLg&s"
    
    },
    {
  "name" : "SpongeBob",
        "power" : 0.6,
        "durability" : 0.9,
        "speed" : 0.4,
        "combat skills" : 0.4,
        "image" : "https://www.spongebobshop.com/cdn/shop/products/SB-Standees-Spong-3_1200x.jpg?v=1603744568"
},
{
        "name" : "Senku",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ1mdHjAqzPc5-gk1krr-dSBOxXr82sOzLcZw&s"
    },
    {
        "name" : "Tsukasa",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://statics.ruadoll.com/image/cache/2023/1103/0/27a9ad9d-3363-75a0-bd42-c88c90613ee9-1000x1000.jpg"
    },
    {
        "name" : "Ban",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://static1.srcdn.com/wordpress/wp-content/uploads/2021/08/Ban-in-The-Seven-Deadly-Sins.jpg"
    },
    {
        "name" : "Itachi",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://res.cloudinary.com/jerrick/image/upload/d_642250b563292b35f27461a7.png,f_jpg,fl_progressive,q_auto,w_1024/64202805dcfea1001d0b7a1a.jpg"
    },
    {
        "name" : "Madara",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://cdns-images.dzcdn.net/images/cover/30e780aee426c1a60d6c866452ce41f4/0x1900-000000-80-0-0.jpg"
    },
    {
        "name" : "Jiraiya",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.6,
        "combat skills" : 0.9,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRxAcUrCIuZmvH0k6co6zeEL58T3uSt5qkFKA&s"
    },
    {
        "name" : "Inosuke",
        "power" : 0.9,
        "durability" : 0.9,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://thathashtagshow.com/wp-content/uploads/2022/01/demon-slayer-inosuke-rescue-season-2-cliffhanger-1024x536.jpg"
    },
    {
        "name" : "Jack Sparrow",
        "power" : 0.9,
        "durability" : 0.6,
        "speed" : 0.8,
        "combat skills" : 0.9,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSPMMq7m9IwMxqFv4Z4JX3zh5WYgq8qmS9mqw&s"

    },
{ 
       "name" : "Chowder",
       "power" : 0.3,
       "durability" : 0.9,
       "speed" : 0.6,
       "combat skills" : 0.5,
       "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTd1AQ68ks-pTURZ3Hhv-Pvk9uNB6iAFqN1Kw&s"
    },

   {
        "name" : "Dr.Barber",
        "power" : 0.8,
        "durability" : 0.4,
        "speed" : 0.5,
        "combat skills" : 0.9,
        "image" : "https://www.clipartmax.com/png/small/5-50354_doctor-julius-barber-dr-barber-flapjack.png"
    },
    
    {
        "name" : "Kira",
        "power" : 0.9,
        "durability" : 0.7,
        "speed" : 0.6,
        "combat skills" : 0.9,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQR2F5Q47U9PZkAE0CvxLyUGyfFtvJlHJmGdQ&s"
    },
    
    {
        "name" : "Shrek",
        "power" : 0.9,
        "durability" : 0.7,
        "speed" :  0.5,
        "combat skills" :  0.9,
        "image" : "https://static1.moviewebimages.com/wordpress/wp-content/uploads/2024/10/shrek.jpg"
    },
    
    {
        "name" : "Snoopy",
        "power" :  0.7,
        "durability" : 0.8,
        "speed" :  0.7,
        "combat skills" :  0.8,
        "image" : "https://static.wixstatic.com/media/449abe_7b15686b2118476da4a733a7861dd772~mv2.jpg/v1/fill/w_1080,h_1080,al_c,q_85/sn-color.jpg"
    },
    
    {
        "name" : "Patrick",
        "power" :  0.1,
        "durability" : 0.9,
        "speed" :  0.5,
        "combat skills" : 0.5,
        "image" : "https://upload.wikimedia.org/wikipedia/en/thumb/3/33/Patrick_Star.svg/1200px-Patrick_Star.svg.png"   
 },
    
    {
        "name" : "Eren",
        "power" : 0.9,
        "durability" : 0.7,
        "speed" : 0.5,
        "combat skills" :  0.9,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRkcKGGLKhsBCkkPFT7Cu6cZB1Q3XjxdZZsMA&s"
    },
    
    {
        "name" :  "Snoop Dogg",
        "power" : 0.2,
        "durability" : 0.6,
        "speed" : 0.5,
        "combat skills" :  0.5,
        "image" : "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTOL6pGmDI5beMercY5pjlPqJ18Q1RwmyHmhw&s"
    },
    
    {
        "name" :  "Dock Hag",
        "power" : 0.6,
        "durability" : 0.5,
        "speed" : 0.2,
        "combat skills" :  0.9,
        "image" : "https://www.clipartmax.com/png/small/467-4677422_dock-hag-flapjack-wiki-harbor-marvelous-misadventures-of-flapjack-dock-hag.png"
    },

    {
        "name" : "Jotaro",
        "power" : 0.8,
        "durability" :  0.3,
        "speed" : 0.4,
        "combat skills" :  0.9,
        "image" : "https://qph.cf2.quoracdn.net/main-qimg-6299e66525633fddbfdb7e00f63d1e8e"
    },
    {
        "name" : "Toby the Tram Engine",
        "power" : 0.6,
        "durability" :  0.5,
        "speed" : 0.8,
        "combat skills" :  0.1,
        "image" : "https://upload.wikimedia.org/wikipedia/en/4/45/TobyCGIpromo.png"
    },
]
let player1Traits = { "power": null, "durability": null, "speed": null, "combat skills": null };
let player2Traits = { "power": null, "durability": null, "speed": null, "combat skills": null };

const shuffleInterval = 100;
let shuffleTimers = {};

// Start the game by shuffling all traits for Player 1 and Player 2 for 1 second initially
function startGame() {
    startShufflingAllTraits(1);
    startShufflingAllTraits(2);
    setTimeout(() => {
        stopShufflingAllTraits(1);
        stopShufflingAllTraits(2);
    }, 1000);
}

// Shuffle images for all traits for a specific player
function startShufflingAllTraits(playerNumber) {
    const traits = ["power", "durability", "speed", "combat skills"];
    traits.forEach((trait) => {

        const playerTraits = playerNumber === 1 ? player1Traits : player2Traits;
        if (!playerTraits[trait]) {
            shuffleImages(trait, playerNumber);
        }
    });
}

// Start shuffling images for a specific trait and player
function shuffleImages(trait, playerNumber) {
    const traitElement = document.getElementById(`${trait}-img-${playerNumber}`);
    shuffleTimers[`${trait}-${playerNumber}`] = setInterval(() => {
        const randomCharacter = characterData[Math.floor(Math.random() * characterData.length)];
        traitElement.src = randomCharacter.image;
        traitElement.dataset.character = randomCharacter.name;
    }, shuffleInterval);

    // Add click event to select the trait
    traitElement.onclick = () => {
        const playerTraits = playerNumber === 1 ? player1Traits : player2Traits;
        if (!playerTraits[trait]) {
            selectTrait(trait, traitElement.dataset.character, playerNumber);
        }
    };
}

// Stop shuffling images for all traits for a specific player
function stopShufflingAllTraits(playerNumber) {
    Object.keys(shuffleTimers).forEach((key) => {
        if (key.endsWith(`-${playerNumber}`)) {
            clearInterval(shuffleTimers[key]);
        }
    });
}

// Function to handle trait selection for a specific player
function selectTrait(trait, characterName, playerNumber) {
    const playerTraits = playerNumber === 1 ? player1Traits : player2Traits;

    // Lock the selected trait with the chosen character
    playerTraits[trait] = characterData.find((c) => c.name === characterName);

    // Stop shuffling for this selected trait
    clearInterval(shuffleTimers[`${trait}-${playerNumber}`]);

    // Check if all traits are selected for both players
    if (
        Object.values(player1Traits).every((trait) => trait !== null) &&
        Object.values(player2Traits).every((trait) => trait !== null)
    ) {
        displayFinalStats();
    } else {
        // Reshuffle remaining traits
        startShufflingAllTraits(playerNumber);
        setTimeout(() => stopShufflingAllTraits(playerNumber), 1000);
    }
}

// Display final stats once all traits are selected and determine the winner
function displayFinalStats() {
    const player1Stats = Object.keys(player1Traits)
        .map((trait) => `<p>${trait.charAt(0).toUpperCase() + trait.slice(1)}: ${player1Traits[trait][trait]}</p>`)
        .join("");
    const player2Stats = Object.keys(player2Traits)
        .map((trait) => `<p>${trait.charAt(0).toUpperCase() + trait.slice(1)}: ${player2Traits[trait][trait]}</p>`)
        .join("");

    document.getElementById("final-stats").innerHTML = `
        <h3>Player 1's Stats:</h3>${player1Stats}
        <h3>Player 2's Stats:</h3>${player2Stats}
    `;

    // Calculate the winner based on aggregated scores
    calculateWinner();
}

// Calculate each player's total score and determine the winner
function calculateWinner() {
    const player1Total =
        player1Traits["combat skills"]["combat skills"] * 2 +
        player1Traits.speed.speed * 1.3 +
        player1Traits.durability.durability * 1.5 +
        player1Traits.power.power * 1.8;

    const player2Total =
        player2Traits["combat skills"]["combat skills"] * 2 +
        player2Traits.speed.speed * 1.3 +
        player2Traits.durability.durability * 1.5 +
        player2Traits.power.power * 1.8;

    const resultText = player1Total > player2Total ? "PLAYER 1 WINS!" : "PLAYER 2 WINS!";
    showOverlay(resultText);
}

// Show overlay with the result text and play again button
function showOverlay(resultText) {
    const overlay = document.getElementById("result-overlay");
    overlay.style.display = "flex";
    overlay.innerHTML = `
        <div class="wrapper">
            <h1>${resultText}</h1>
            <button onclick="resetGame()" class="button">
                <div class="blob1"></div>
                <div class="blob2"></div>
                <div class="inner">Play Again</div>
            </button>
        </div>
    `;
}

// Reset the game to start over
function resetGame() {
    player1Traits = { power: null, durability: null, speed: null, "combat skills": null };
    player2Traits = { power: null, durability: null, speed: null, "combat skills": null };
    document.getElementById("final-stats").innerHTML = ""; // Clear final stats display
    document.getElementById("result-overlay").style.display = "none"; // Hide overlay
    startGame();
}

window.onload = startGame;
